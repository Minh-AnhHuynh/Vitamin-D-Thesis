<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.319">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>chapitre_2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="05-chapitre_2_files/libs/clipboard/clipboard.min.js"></script>
<script src="05-chapitre_2_files/libs/quarto-html/quarto.js"></script>
<script src="05-chapitre_2_files/libs/quarto-html/popper.min.js"></script>
<script src="05-chapitre_2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="05-chapitre_2_files/libs/quarto-html/anchor.min.js"></script>
<link href="05-chapitre_2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="05-chapitre_2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="05-chapitre_2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="05-chapitre_2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="05-chapitre_2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="vitamine-d-et-système-immunitaire" class="level1">
<h1>Vitamine D et système immunitaire</h1>
<p>L’importance cruciale du rôle de la vitamine D sur le système immunitaire a récemment captivé l’attention des chercheurs depuis la découverte de la coexistence du et du dans des tissus dont la fonction n’est pas directement liée à l’homéostasie du calcium <span class="citation" data-cites="Zehnder.2001">[@Zehnder.2001]</span>. En particulier, l’expression du dans les cellules immunitaires est régulée indépendamment de l’homéostasie du calcium, en présence ou non de pathogènes, ce qui démontre le rôle central de la vitamine D dans la régulation du système immunitaire <span class="citation" data-cites="White.2022">[@White.2022]</span>.</p>
<p>La vitamine D agit à la fois sur les cellules du système immunitaire inné et adaptatif par de nombreuses fonctions et effets (). Deux observations principales supportent la théorie du rôle de la vitamine D dans le système immunitaire : le récepteur au calcitriol est présent dans toutes les cellules immunitaires, et la présence de l’enzyme de conversion finale du calcidiol en calcitriol, la 1-α-hydroxylase est uprégulée par certaines cellules immunes <span class="citation" data-cites="Giannini.2022">[@Giannini.2022]</span>.</p>
<p>Ainsi, plusieurs cellules immunitaires peuvent synthétiser l’enzyme clé permettant la conversion du 25(OH)<sub>2</sub>D<sub>3</sub> en 1,25(OH)<sub>2</sub>D<sub>3</sub>, le cytochrome CYP27B1 ou aussi appelée 1-α-hydroxylase. L’induction de cette enzyme concerne des cellules telles que les cellules dendritiques, monocytes, macrophages, lymphocytes B et T <span class="citation" data-cites="Giannini.2022 Dankers.2017">[@Giannini.2022 ; @Dankers.2017]</span>.</p>
<p>Dans ce contexte, l’enzyme 1-α-hydroxylase n’est pas uprégulée par la . Par conséquent, la production de 1,25(OH)<sub>2</sub>D<sub>3</sub> dépend des niveaux de substrat de 25(OH)D<sub>3</sub> et peut être régulée par des signaux inflammatoires, tels que le et les cytokines <span class="citation" data-cites="Giannini.2022">[@Giannini.2022]</span>.</p>
<!-- TODO: Développer intracrine extracrine, peut-être même une sous-partie avec PREUVE et REFERENCE -->
<!-- L'action de la vitamine D peut être jugée intracrine puisqu'elle se -->
<!-- déroule à l'intérieur de la cellule, et non à l'extérieur de la cellule, -->
<!-- ce qui correspondrait à une action autocrine. -->
<div id="fig-vd-immune-effect" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/vd-immune-effect.jpg" class="img-fluid figure-img" data-fig.pos="!htb"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: <strong>Effets du calcitriol sur les réponses immunitaires sous des conditions normales.</strong> La 1,25(OH)<sub>2</sub>D<sub>3</sub> régule à la fois l’immunité innée et l’immunité adaptative, en potentialisant la réponse innée (activité antimicrobienne des macrophages), en diminuant la présentation de l’antigène et en supprimant l’immunité adaptative (fonctions des lymphocytes B et de certains lymphocytes T). Cependant, dans des conditions normales, la 1,25(OH)<sub>2</sub>D<sub>3</sub> augmente les cytokines T helper (Th<sub>2</sub>) (c’est-à-dire l’) et l’efficacité des lymphocytes T régulateurs (T<sub>reg</sub>). DC, cellules dendritiques ; APC, cellules présentatrices d’antigènes ; TLR, Toll-like receptor. D’après <span class="citation" data-cites="Cutolo.2014">@Cutolo.2014</span></figcaption><p></p>
</figure>
</div>
<section id="mécanismes-daction-de-la-vitamine-d-sur-le-système-immunitaire" class="level2">
<h2 class="anchored" data-anchor-id="mécanismes-daction-de-la-vitamine-d-sur-le-système-immunitaire">Mécanismes d’action de la vitamine D sur le système immunitaire</h2>
<p>La vitamine D possède une action globalement anti-inflammatoire et donc régulatrice de l’inflammation (). Elle agit à la fois sur le système immunitaire inné et adaptatif. A l’initiation de la réponse inflammatoire, le calcitriol est essentiel afin de répondre à une infection.</p>
<section id="fonctions-et-effets-de-la-vitamine-d-sur-les-cellules-immunitaires-innées" class="level3">
<h3 class="anchored" data-anchor-id="fonctions-et-effets-de-la-vitamine-d-sur-les-cellules-immunitaires-innées">Fonctions et effets de la vitamine D sur les cellules immunitaires innées</h3>
<p>Plusieurs signaux sont nécessaires à l’induction de la 1-α-hydroxylase, tels que la présence d’activateurs de macrophages et de monocytes comme le ou l’, ainsi que les récepteurs innés . Lorsque les cellules sont activées, elles expriment le qui va permettre de métaboliser le calcidiol en calcitriol <span class="citation" data-cites="Liu.2006 Charoenngam.2020">[@Liu.2006; @Charoenngam.2020]</span>.</p>
<p>Le calcitriol peut ensuite agir de manière intracrine via un signalement VDR-RXR qui va induire la production de cathélicidine LL-37 et de β2-défensine <a href="#fig-vd-action">Figure&nbsp;2</a>. La cathélicidine est un peptide antimicrobien luttant contre les bactéries et les fongi en déstabilisant leurs membranes <span class="citation" data-cites="Charoenngram.2020">[@Charoenngram.2020]</span>. Le calcitriol est capable entre autre d’induire la reconnaissance des pathogènes par le biais du TLR et le switch phénotypique de macrophage M1 vers M2 par la régulation positive de l’. Le calcitriol inhibe également des cytokines majeures pro-inflammatoires, l’ et le <span class="citation" data-cites="Meza-Meza.2022 Caprio.2017">[@Meza-Meza.2022; @Caprio.2017]</span>.</p>
<p>Le calcitriol joue également un rôle paracrine puisqu’il va agir sur les cellules immunitaires environnantes, notamment sur les cellules immunitaires adaptatives.</p>
<p>Il est intéressant de noter une conséquence involontaire de cette fonction paracrine est que les macrophages produisent une quantité excessive de 1,25(OH)2D qui pénètre dans la circulation et stimule de manière non régulée l’absorption intestinale du calcium et la mobilisation du calcium osseux, ce qui entraîne une hypercalciurie et une hypercalcémie [23,24]. Ce phénomène est plus susceptible de se produire lorsque les taux circulants de</p>
<div id="fig-vd-action" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/vd-action.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: <strong>Représentation schématique des fonctions paracrine et intracrine de la vitamine D et de ses métabolites et des actions de la 1,25-dihydroxyvitamine D sur les systèmes immunitaires innés et adaptatifs.</strong> Abréviation : 1,25(OH)2D : 1,25-dihydroxyvitamine D ; 25(OH)D : 25-hydroxyvitamine D, IFN-Ƴ : interféron- Ƴ ; IL : interleukine ; CMH : complexe d’histocompatibilité membranaire, TH1 : T helper 1 ; TH2 : T helper 2 ; TH17 : T helper 17 ; Treg : cellule T régulatrice, TNF-α : Tumor necrosis factor- α ; TLR2 : toll-like receptor 2 ; TLR4 : toll-like receptor 4. <span class="citation" data-cites="Charoenngam.2020">[@Charoenngam.2020]</span></figcaption><p></p>
</figure>
</div>
<hr>
<p>Les mécanismes d’action de la vitamine D sur le système immunitaire sont étroitement liés à son rôle anti-inflammatoire et à sa capacité à réguler l’inflammation, tant dans le système immunitaire inné que dans le système immunitaire adaptatif (). Lors de l’initiation de la réponse inflammatoire, le calcitriol joue un rôle essentiel dans la réponse aux infections.</p>
</section>
<section id="fonctions-et-effets-de-la-vitamine-d-sur-les-cellules-immunitaires-innées-1" class="level3">
<h3 class="anchored" data-anchor-id="fonctions-et-effets-de-la-vitamine-d-sur-les-cellules-immunitaires-innées-1">Fonctions et effets de la vitamine D sur les cellules immunitaires innées</h3>
<p>Au sein du système immunitaire inné, plusieurs signaux sont nécessaires pour induire l’activité de l’enzyme 1-α-hydroxylase, tels que la présence d’activateurs de macrophages tels que le . De plus, les sont capables de réguler positivement l’expression du et des gènes codant pour la 1-α-hydroxylase, contribuant ainsi à une immunité médiée par la vitamine D <span class="citation" data-cites="Liu.2006">[@Liu.2006]</span>.</p>
<p>La vitamine D agit sur les macrophages en induisant leur activation et leur différenciation, ce qui entraîne une augmentation de la production de peptides défensifs tels que la cathélicidine et la β2-défensine <span class="citation" data-cites="Caprio.2017">[@Caprio.2017]</span>. Le calcitriol est également capable de favoriser la reconnaissance des pathogènes par le biais des récepteurs de type Toll et de promouvoir la transition phénotypique des macrophages de l’état M1 à l’état M2 en régulant positivement la production d’IL-10. De plus, le calcitriol inhibe les cytokines pro-inflammatoires majeures telles que l’IL-6 et le TNF-α <span class="citation" data-cites="Meza-Meza.2022 Caprio.2017">[@Meza-Meza.2022; @Caprio.2017]</span>.</p>
<p>Une fois le calcidiol métabolisé en calcitriol, cette forme active va agir de manière intracrine et paracrine sur les cellules environnantes. </p>
<p>Cette forme active renforce les activités antimicrobiennes des macrophages et des monocytes, et stimule la production de cathélicidine LL-37, une molécule qui agit contre les micro-organismes et les virus envahissants en déstabilisant leurs membranes. De plus, des études ont montré que la vitamine D influence la fonction des lymphocytes T cytotoxiques (CTL), car de faibles taux de 25(OH)D sont associés à une activation immunitaire accrue. Une supplémentation en vitamine D3 peut entraîner une immunosuppression et une augmentation du rapport CD4/CD8, indiquant ainsi une amélioration de la fonction immunitaire. Les effets de la vitamine D sur les CTL sont probablement médiés à la fois par l’activation directe des récepteurs de la vitamine D et par l’altération de la signalisation des cytokines via les cellules T auxiliaires et les cellules présentatrices d’antigènes. Dans l’ensemble, la vitamine D joue un rôle crucial dans l’immunité innée, offrant des effets protecteurs potentiels contre les maladies auto-immunes <span class="citation" data-cites="Charoenngam.2020">[@Charoenngam.2020]</span>.</p>
<ul>
<li>Expliquer comment la vitamine D influence les cellules immunitaires innées telles que les macrophages, les cellules dendritiques et les cellules tueuses naturelles.</li>
<li>Mettre en évidence les effets de la vitamine D sur l’activation, la différenciation et les réponses inflammatoires des cellules immunitaires innées.</li>
</ul>
<p>B. Fonctions et effets de la vitamine D sur les cellules immunitaires adaptatives - Expliquer comment la vitamine D modifie les réponses des lymphocytes T et B, les principales cellules immunitaires adaptatives. - Souligner l’importance de la vitamine D dans la régulation de l’équilibre entre les réponses immunitaires pro-inflammatoires et anti-inflammatoires.</p>
<p>C. Implications de la vitamine D dans la réponse immunitaire antivirale - Discuter des mécanismes par lesquels la vitamine D peut influencer la réponse immunitaire antivirale, notamment en régulant la production d’interférons et en modulant la fonction des cellules immunitaires antivirales. - Mettre en évidence les études qui ont examiné le rôle de la vitamine D dans la lutte contre les infections virales, y compris le COVID-19.</p>
<p>_____________________</p>
<p>De plus, la vitamine D agit également sur le système immunitaire adaptatif avec des effets inhibiteurs. Elle est capable d’induire une tolérance immunitaire en favorisant l’adoption d’un phénotype immature (cellules dendritiques, macrophages, lymphocytes B), par une diminution de l’expression du ainsi que des marqueurs de co-stimulation, nécessaires à l’activation de la réponse immune, tels que le CD40, CD80 et CD86 <span class="citation" data-cites="Meza-Meza.2020 Caprio.2017">[@Meza-Meza.2020; @Caprio.2017]</span>.</p>
<p>Elle est également capable d’induire le changement phénotypique de sous-population de lymphocytes T CD4<sup>+</sup>, favorisant le passage de la population T auxiliaire (Th) Th1 et Th17 vers la population Th2. La sous-population Th2 régule à son tour les populations Th1 et Th17 dans un équilibre, diminuant ainsi globalement l’activité cytotoxique médiée par les cellules, qui est exacerbée dans les maladies autoimmunes et infections par des pathogènes<span class="citation" data-cites="Holick.2011 Meza-Meza.2020">[@Holick.2011; @Meza-Meza.2020]</span>.</p>
<p>Il a aussi été montré que l’action de la vitamine D sur son récepteur VDR était nécessaire au fonctionnement des lymphocytes T régulateurs iNKT et CD8αα <span class="citation" data-cites="Cheroutre.2008">[@Cheroutre.2008]</span>. Les lymphocytes T CD8αα possèdent un caractère régulateur contrairement au lymphocyte CD8αβ classique. Ainsi, ces lymphocytes T régulateurs contribuent à l’homéostasie du tractus intestinal <span class="citation" data-cites="Cantorna.2010">[@Cantorna.2010]</span>. A l’inverse, les lymphocytes FoxP3<sup>+</sup> T<sub>reg</sub> sont fonctionnellement indépendant de l’expression de VDR pour effectuer leurs fonctions régulatrices <span class="citation" data-cites="Cantorna.2010">[@Cantorna.2010]</span>.</p>
<p>La vitamine D est également capable d’agir non-classiquement par des actions non-génomique, à savoir des actions de type protéine-protéine, telle que l’inhibition de la kinase IKκβ, un régulateur de la voie canonique de NF-κB, une des cytokines pro-inflammatoire clé de la réaction immunitaire <span class="citation" data-cites="Hii.2016">[@Hii.2016]</span>.</p>
<p>___________</p>
<div id="fig-immunomod" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/calcitriol-immunomodulatory.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: <strong>Effets immunomodulateurs du calcitriol.</strong> <span class="citation" data-cites="Meza-Meza.2022">@Meza-Meza.2022</span></figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="mécanisme-daction-de-la-vitamine-d" class="level2">
<h2 class="anchored" data-anchor-id="mécanisme-daction-de-la-vitamine-d">Mécanisme d’action de la vitamine D</h2>
<p>L’effet de la vitamine D a été observé lors d’une infection par <em>Mycobacterium tuberculosis</em> sur les monocytes, où lors d’une expérience in vitro, des monocytes traités avec du calcitriol, la forme active de la vitamine D, conduisent à une réduction de la croissance de <em>M. tuberculosis</em> <span class="citation" data-cites="Hewison.2011">[@Hewison.2011]</span>. Ces observations concernent un pathogène bactérien, cependant il existe des parallèles importants entre les mécanismes de réponses antibactériens et antiviraux dans la réponse immunitaire innée <span class="citation" data-cites="White.2022">[@White.2022]</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/vd-mecha-cathelicidin.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Méchanisme d’action de l’induction de la cathélicidine par la vitamine D.</figcaption><p></p>
</figure>
</div>
<section id="action-antivirale-sur-le-système-immunitaire-inné" class="level3">
<h3 class="anchored" data-anchor-id="action-antivirale-sur-le-système-immunitaire-inné">Action antivirale sur le système immunitaire inné</h3>
<p>Récemment, les études ont élucidés l’importance de la vitamine D dans de multiples régulations au sujet de l’immunité innée. Le calcitriol stimule ainsi la transcription de multiples éléments intervenants dans la réponse immunitaire innée tels que les PRRs, le CD14, cofacteur du TLR4, TLR2 et NOD2 <span class="citation" data-cites="White.2022">[@White.2022]</span>.</p>
<p>La vitamine D stimule également le signalement cytokinique, avec induction de chimiokines comme l’IL-8/CXCL8, une chimiokine de neutrophile.</p>
<p>Elle stimule la production de peptides antimicrobiens, AMPs, CAMP, HBD2, DEFB4, les 2 derniers éléments contiennent/permettent le VDRE.</p>
<p>Le TLR2 induit CYP27B1, ce qui convertit le calcidiol en calcitriol. Le calcitriol induit alors CAMP. Cette induction dépend de la concentration en calcidiol, et une concentration insuffisante ne permet pas une induction en CAMP, ce qui renforce l’importance d’une concentration adéquate en vitamine D appropriée pour le système immunitaire <span class="citation" data-cites="White.2022">[@White.2022]</span>. <em>Le calcitriol induit plusieurs fois la transcription de CAMP dans les cellules épithéliales et myéloïdes in vitro; il est plus efficace pour augmenter l’expression de HBD2/DEFB4 stimulée par d’autres signaux. L’expression de HBD2/DEFB4 stimulée par d’autres signaux tels que l’IL-1β servant ainsi davantage de régulateur secondaire du gène.</em></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/vd-amp.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Contribution de l’immunité induite par AMP sur le SARS-CoV-2</figcaption><p></p>
</figure>
</div>
</section>
<section id="action-paracrine-et-intracrine" class="level3">
<h3 class="anchored" data-anchor-id="action-paracrine-et-intracrine">Action paracrine et intracrine</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/meca-intracrine.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Mécanismes des réponses immunitaires innées et adaptatives à la vitamine D.</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="dose-de-vitamine-d-nécessaire-à-limmunité" class="level2">
<h2 class="anchored" data-anchor-id="dose-de-vitamine-d-nécessaire-à-limmunité">Dose de vitamine D nécessaire à l’immunité</h2>
<p><span class="citation" data-cites="Hewison.2007">@Hewison.2007</span></p>
</section>
<section id="molecular-mechanisms-underlying-immunomodulation" class="level2">
<h2 class="anchored" data-anchor-id="molecular-mechanisms-underlying-immunomodulation">Molecular Mechanisms Underlying Immunomodulation</h2>
<p><span class="citation" data-cites="Dankers.2017">@Dankers.2017</span></p>
<p>In addition to the studies where cholecalciferol has been supplemented, attention has also focused on understanding the immunomodulatory effects of 1,25(OH)2D3 on a cellular level. Based on the current knowledge, 1,25(OH)2D3 reduced the pathogenicity of DCs, macrophages, CD4+ T cells, CD8+ T cells, and B cells. Similar effects have been observed in γδ T cells, iNKT cells, and ILCs, but more research is necessary to confirm these data (see section 5). It should be noted that 1,25(OH)2D3 does not merely work as an anti-inflammatory agent. Instead, 1,25(OH)2D3 assists in maintaining the balance between a pro- and anti-inflammatory state and is thereby able to restore the disturbed balance that is associated with autoimmunity. This balancing effect of 1,25(OH)2D3 is best illustrated in monocytes and macrophages, where it has pro-inflammatory effects in the early stages of activation but later shifts to an antiinflammatory state (242). Therefore, it is interesting to study the effects of 1,25(OH)2D3 in more detail in the various stages of differentiation and activation from monocyte to macrophage. The Carlberg lab has performed ChIP-seq experiments in the monocytic THP-1 cell line at early time points (5). Detailed studies have revealed several primary target genes such as ASAP2 and THBD (243–245), but also identified Bcl6 as a primary target that mediates important secondary responses (246). Next to the primary target genes, combining the ChIP-seq dataset with publically available ChIA-PET and FAIRE-seq datasets has improved the knowledge on VDR binding kinetics (247, 248).</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>